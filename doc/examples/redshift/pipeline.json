{
    "pipeline": {
        "name": "upload_to_redshift"
    },
    "inputs": [
      {
        "repo": { "name": "data" },
        "method": "reduce"
      }
    ],
    "transform": {
        "image": "postgres:9.6.1-alpine",
        "cmd" : ["/bin/sh"],
        "stdin": [
            "chmod 600  '/secrets/pgpass/pgpass'",
            "psql -w -h ${REDSHIFT_ENDPOINT} -U ${REDSHIFT_USER} -p ${REDSHIFT_PORT} -d ${REDSHIFT_DB}"
        ],
        "env": {
          "PGPASSFILE": "/secrets/pgpass/pgpass",
          "REDSHIFT_ENDPOINT": "redshift-test.caz8kuesomc0.us-west-2.redshift.amazonaws.com",
          "REDSHIFT_USER": "testuser",
          "REDSHIFT_PORT": "5439",
          "REDSHIFT_DB": "dev"
        },
        "secrets": [
            {
              "name": "pgpass-secret",
              "mountPath": "/secrets/pgpass"
            }
        ]
    },
    "parallelism_spec": {
      "strategy": "CONSTANT",
      "constant": 1
    }
}
